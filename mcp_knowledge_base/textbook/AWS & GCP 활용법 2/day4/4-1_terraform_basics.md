# 4-1. Terraform μ†κ° λ° κΈ°λ³Έ μ‚¬μ©λ²•

μ΄ μ±•ν„°μ—μ„λ” "μ½”λ“λ΅ μΈν”„λΌ κ΄€λ¦¬ν•κΈ°(Infrastructure as Code, IaC)"μ κ°λ…μ„ λ°°μ°κ³ , λ€ν‘μ μΈ IaC λ„κµ¬μΈ Terraformμ ν•µμ‹¬ κ°λ…κ³Ό κΈ°λ³Έ λ…λ Ήμ–΄ μ‚¬μ©λ²•μ„ μµν™λ‹λ‹¤. μ½”λ“ κΈ°λ°μ μλ™ν™”λκ³  μ¬ν„ κ°€λ¥ν• μΈν”„λΌ κ΄€λ¦¬μ μ„Έκ³„λ΅ λ“¤μ–΄κ°€λ” μ²«κ±Έμμ…λ‹λ‹¤.

---

### Terraform ν•µμ‹¬ κ°λ…

Terraformμ€ λ‡ κ°€μ§€ ν•µμ‹¬μ μΈ κ°λ… μ„μ— κµ¬μ¶•λμ—μµλ‹λ‹¤. μ΄λ¥Ό μ΄ν•΄ν•λ” κ²ƒμ΄ Terraformμ„ λ§μ¤ν„°ν•λ” μ—΄μ‡ μ…λ‹λ‹¤.

- **Provider:** ν΄λΌμ°λ“ ν”λ«νΌ(AWS, GCP, Azure λ“±)μ΄λ‚ μ„λΉ„μ¤(GitHub, Datadog λ“±)μ™€μ μ—°λ™μ„ λ‹΄λ‹Ήν•©λ‹λ‹¤. μ–΄λ–¤ APIμ™€ ν†µμ‹ ν• μ§€λ¥Ό μ •μν•©λ‹λ‹¤.
- **Resource:** ν”„λ΅λΉ„μ €λ‹ν•  μΈν”„λΌμ μµμ† λ‹¨μ„μ…λ‹λ‹¤. EC2 μΈμ¤ν„΄μ¤, S3 λ²„ν‚·, VPC λ“± λ¨λ“  κ²ƒμ΄ λ¦¬μ†μ¤κ°€ λ  μ μμµλ‹λ‹¤. `resource "aws_instance" "my_server" { ... }` μ™€ κ°™μ€ ν•νƒλ΅ μ„ μ–Έν•©λ‹λ‹¤.
- **State:** Terraformμ΄ κ΄€λ¦¬ν•λ” μΈν”„λΌμ ν„μ¬ μƒνƒλ¥Ό κΈ°λ΅ν•λ” νμΌ(`terraform.tfstate`)μ…λ‹λ‹¤. μ½”λ“μ™€ μ‹¤μ  μΈν”„λΌ κ°„μ λ§¤ν•‘ μ •λ³΄λ¥Ό λ‹΄κ³  μμΌλ©°, λ§¤μ° μ¤‘μ”ν•κ² λ‹¤λ£¨μ–΄μ•Ό ν•©λ‹λ‹¤.
- **Variable:** μ½”λ“μ μ¬μ‚¬μ©μ„±μ„ λ†’μ΄κΈ° μ„ν•΄ μ‚¬μ©λ©λ‹λ‹¤. λ¦¬μ „, μΈμ¤ν„΄μ¤ νƒ€μ… λ“± λ³€κ²½λ  μ μλ” κ°’λ“¤μ„ λ³€μλ΅ λ¶„λ¦¬ν•μ—¬ κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.
- **Output:** μƒμ„±λ μΈν”„λΌμ μ •λ³΄(μ: EC2 μΈμ¤ν„΄μ¤μ IP μ£Όμ†, S3 λ²„ν‚·μ μ΄λ¦„)λ¥Ό ν„°λ―Έλ„μ— μ¶λ ¥ν•κ±°λ‚ λ‹¤λ¥Έ Terraform λ¨λ“μ—μ„ μ‚¬μ©ν•  μ μλ„λ΅ μ •μν•©λ‹λ‹¤.

### Terraform κΈ°λ³Έ λ…λ Ήμ–΄

Terraformμ€ κ°„λ‹¨ν• λ‡ κ°€μ§€ λ…λ Ήμ–΄λ΅ μΈν”„λΌμ μ „μ²΄ μƒλ…μ£ΌκΈ°λ¥Ό κ΄€λ¦¬ν•©λ‹λ‹¤.

1.  **`terraform init`**
    -   μ‘μ—… λ””λ ‰ν„°λ¦¬λ¥Ό μ΄κΈ°ν™”ν•λ” κ°€μ¥ μ²« λ‹¨κ³„μ λ…λ Ήμ–΄μ…λ‹λ‹¤.
    -   μ½”λ“μ— μ„ μ–Έλ Providerλ¥Ό λ‹¤μ΄λ΅λ“ν•κ³ , λ°±μ—”λ“ λ° λ¨λ“μ„ μ„¤μ •ν•©λ‹λ‹¤.
    -   Terraform μ½”λ“λ¥Ό μ‘μ„±ν•κ±°λ‚ λ‚΄λ ¤λ°›μ€ ν›„, κ°€μ¥ λ¨Όμ € μ‹¤ν–‰ν•΄μ•Ό ν•©λ‹λ‹¤.

2.  **`terraform plan`**
    -   μ‘μ„±λ μ½”λ“λ¥Ό ν„μ¬ μΈν”„λΌ μƒνƒ(State)μ™€ λΉ„κµν•μ—¬, μ–΄λ–¤ λ¦¬μ†μ¤κ°€ μƒμ„±/λ³€κ²½/μ‚­μ λ μ§€λ¥Ό λ―Έλ¦¬ λ³΄μ—¬μ£Όλ” "μ‹¤ν–‰ κ³„ν"μ„ μƒμ„±ν•©λ‹λ‹¤.
    -   μ‹¤μ  μΈν”„λΌμ— λ³€κ²½μ„ κ°€ν•κΈ° μ „μ—, μμƒλλ” λ³€κ²½ μ‚¬ν•­μ„ μ•μ „ν•κ² κ²€ν† ν•  μ μλ” λ§¤μ° μ¤‘μ”ν• λ‹¨κ³„μ…λ‹λ‹¤.

3.  **`terraform apply`**
    -   `plan` λ‹¨κ³„μ—μ„ μƒμ„±λ μ‹¤ν–‰ κ³„νμ„ μ‹¤μ λ΅ μΈν”„λΌμ— μ μ©ν•©λ‹λ‹¤.
    -   "yes"λ¥Ό μ…λ ¥ν•΄μ•Όλ§ μ‹¤ν–‰λλ©°, μ΄ λ…λ Ήμ„ ν†µν•΄ μ½”λ“κ°€ μ‹¤μ  ν΄λΌμ°λ“ λ¦¬μ†μ¤λ΅ λ§λ“¤μ–΄μ§‘λ‹λ‹¤.

4.  **`terraform destroy`**
    -   Terraform μ½”λ“λ΅ κ΄€λ¦¬λλ” λ¨λ“  μΈν”„λΌλ¥Ό μ‚­μ ν•©λ‹λ‹¤.
    -   μ‹¤μµ ν›„ λ¦¬μ†μ¤λ¥Ό μ •λ¦¬ν•κ±°λ‚, λ” μ΄μƒ ν•„μ” μ—†λ” ν™κ²½μ„ μ κ±°ν•  λ• μ‚¬μ©ν•©λ‹λ‹¤. `apply`μ™€ λ§μ°¬κ°€μ§€λ΅ λ§¤μ° κ°•λ ¥ν• λ…λ Ήμ–΄μ΄λ―€λ΅ μ‹ μ¤‘ν•κ² μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤.

---

### π’΅ μ•μ•„λ‘λ©΄ μΆ‹μ€ μ 

- **μ λ€, μ λ€, μƒνƒ νμΌμ„ μλ™μΌλ΅ μμ •ν•μ§€ λ§μ„Έμ”:** `terraform.tfstate` νμΌμ€ Terraformμ΄ μ‹¤μ  μΈν”„λΌμ™€ μ½”λ“λ¥Ό λ§¤ν•‘ν•λ” λ‘λ‡μ™€ κ°™μµλ‹λ‹¤. μ΄ νμΌμ„ μ§μ ‘ μμ •ν•λ” κ²ƒμ€ λ§¤μ° μ„ν—ν•λ©°, μΈν”„λΌ μƒνƒκ°€ κΌ¬μ΄λ” κ°€μ¥ λΉ λ¥Έ μ§€λ¦„κΈΈμ…λ‹λ‹¤. μƒνƒλ¥Ό λ³€κ²½ν•΄μ•Ό ν•  λ•λ” `terraform import`λ‚ `terraform state`μ™€ κ°™μ€ λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•μ„Έμ”.
- **λ¨λ“ν™”μ μ¤‘μ”μ„±:** ν”„λ΅μ νΈκ°€ μ»¤μ§€λ©΄ ν•λ‚μ `main.tf` νμΌλ΅ λ¨λ“  κ²ƒμ„ κ΄€λ¦¬ν•κΈ°λ” λ¶κ°€λ¥ν•©λ‹λ‹¤. Terraformμ `λ¨λ“(Module)` κΈ°λ¥μ„ μ‚¬μ©ν•λ©΄ VPC, λ°μ΄ν„°λ² μ΄μ¤, μ• ν”λ¦¬μΌ€μ΄μ… λ“± μΈν”„λΌμ κ° λ¶€λ¶„μ„ μ¬μ‚¬μ© κ°€λ¥ν• λΈ”λ΅μΌλ΅ λ§λ“¤μ–΄ μ²΄κ³„μ μΌλ΅ κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.
