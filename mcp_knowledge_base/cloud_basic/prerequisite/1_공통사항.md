# 공통 운영 규칙 + 플랫폼별 등록/권한 부여 절차  **사전 운영 수칙 문서** 

## 📌 1. 공통 원칙 요약

* 계정/권한 준비: 참가자는 **Contributor**, 교관은 **Owner/Administrator**
* MFA 필수, 비용 권한은 재무 담당자 전담
* CLI 설치: `az`, `aws`, `gcloud` (+ 선택: `kubectl`, `terraform`)
* 공통 리전/명명/태깅 규칙 합의
* 예산/알림 사전 설정, 샘플 자산(`site/`) 준비
* 비밀관리 솔루션(Secret Manager/Key Vault/Secrets Manager) 중 하나 선정
* IaC 리포지토리와 PR 보호, 보안스캔 파이프라인 준비
* 역할 분리 수칙 적용 (예: `ROLE=cost-manager` → 변경 스크립트 차단)

---

## 📌 2. 계정 및 권한 모델

* Azure / AWS / GCP 학습용 구독/프로젝트/계정 준비 (과금 한도, 예산 설정 필수)
* 권한 권장:

  * 교관: **Owner / Administrator**
  * 참가자: **Contributor / Developer**
* 결제·청구 권한은 **재무 담당자 한정**

---

## 📌 3. 도구 및 환경 준비

* CLI 설치:

  * Windows: `winget install` (Azure CLI, AWS CLI, Google Cloud SDK, Terraform)
  * macOS: `brew install azure-cli awscli google-cloud-sdk terraform`
* 인증 방법:

  * Azure: `az login`
  * AWS: `aws configure sso` 또는 `aws configure`
  * GCP: `gcloud auth login`
* 환경변수 예시:

  ```bash
  setx AWS_PROFILE default
  setx AWS_REGION ap-northeast-2
  setx PROJECT_ID my-project
  setx BILLING_ACCOUNT 1234-5678-9012
  setx SUB_ID xxxxx-xxxx
  ```
* VS Code + 확장팩(Azure/AWS/GCP/Terraform) 권장

---

## 📌 4. 표준 및 명명 규칙

* 리소스 명명: `<team>-<env>-<service>-<seq>`

  * 예: `dev-lab-web-01`
* 태그/라벨: `project`, `department`, `env`, `owner`, `cost-center`
* 리전: 동일 리전 사용 (예: Azure Korea Central, AWS ap-northeast-2, GCP asia-northeast3)

---

## 📌 5. 비용 관리

* 각 플랫폼 Budget 기능으로 **예산 생성 + 알림 설정**
* Cost Explorer / Cost Management 대시보드 저장
* 무태그 자산 리포트 → DevOps 팀과 공유하여 보완

---

## 📌 6. 리포지토리 및 자동화 (선택)

* Git 리포지토리 분리: `/infra`(Terraform), `/app`(애플리케이션)
* PR 보호: 리뷰 필수, CI에서 `terraform plan`, lint, security scan 실행
* 워크플로 예: `.github/workflows/iac-ci.yml` (tfsec/checkov)

---

## 📌 7. 샘플 자산 및 보안

* 샘플 자산: 정적 웹 콘텐츠 `./site/`
* 도메인(Optional): DNS 실습용 서브도메인 또는 `nip.io`
* 테스트 스크립트: 부하, 헬스체크, 권한 검증용
* 비밀관리: Secret Manager / Key Vault / Secrets Manager 중 택1
* 크리덴셜 로테이션 전략 + 접근 로깅 활성화

---

## 📌 8. 팀 역할 분담

* 재무팀: 태깅, 예산, 알림 책임
* DevOps: IaC, 파이프라인, 공통 모듈 책임
* 개발팀: 애플리케이션 배포, 헬스체크, 기능 검증
* SRE: 모니터링, 알림, 런북 담당

---

## 📌 9. 역할 분리 실행 수칙

* `ROLE=cost-manager` 설정 시, 변경/프로비저닝 스크립트 실행 차단
* 비용관리자는 **예산/비용/리포트** 스크립트만 실행
* DevOps는 **리소스 생성/변경**만 담당 (비용 권한 없음)

---

## 📌 10. 플랫폼별 등록 절차 (재무 담당자용)

### 🔹 AWS

1. **Billing 콘솔** → `Account settings` → `IAM user and role access to Billing information` 활성화
2. `CostManagers` 그룹 생성 후 정책 부여:

   * `job-function/Billing`
   * `AWSBudgetsReadOnlyAccess` (또는 `AWSBudgetsActionsWithAWSResourceControl`)
   * `ReadOnlyAccess` (선택)
3. 사용자 추가 CLI 예시:

   ```bash
   aws iam create-group --group-name CostManagers
   aws iam attach-group-policy --group-name CostManagers \
     --policy-arn arn:aws:iam::aws:policy/job-function/Billing
   aws iam attach-group-policy --group-name CostManagers \
     --policy-arn arn:aws:iam::aws:policy/AWSBudgetsReadOnlyAccess
   aws iam add-user-to-group --user-name finance-user --group-name CostManagers
   ```

### 🔹 Azure

* 포털: `Cost Management + Billing` → `Billing scope` → `Access control (IAM)`
* 역할 할당:

  * Billing scope: `Billing Reader`
  * 구독/관리그룹: `Cost Management Reader`
  * 필요 시: `Cost Management Contributor` 최소 범위
* 리소스 그룹/구독은 `Reader` 이상 권한 부여 금지

### 🔹 GCP

* Billing → `Account management` → `Permissions`
* 권한:

  * `roles/billing.viewer`
  * 필요 시 `roles/billing.costsManager`
* 프로젝트 권한: `roles/viewer`
* CLI 예시:

  ```bash
  gcloud beta billing accounts add-iam-policy-binding BILLING_ACCOUNT_ID \
    --member=user:finance@example.com --role=roles/billing.viewer
  gcloud beta billing accounts add-iam-policy-binding BILLING_ACCOUNT_ID \
    --member=user:finance@example.com --role=roles/billing.costsManager
  ```

---

## 📌 운영 팁

* 비용 태그/라벨 표준을 **재무팀이 주기적 점검**
* 무태그 리소스 리포트 → DevOps와 공유하여 개선 사이클 유지

---


---
다음 ▶: [2_계정등록.md](2_계정등록.md)

