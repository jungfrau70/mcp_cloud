# 지식베이스 문서 편집 & AI 문서 생성 사용자 안내서

> 이 문서는 “화면만 봐서는 어떻게 쓰는지 모르겠다”는 피드백을 반영하여, **실제 사용 순서**와 **자주 하는 작업** 중심으로 재구성되었습니다. 3분 안에 핵심 흐름을 이해할 수 있도록 작성되었습니다.

---
## 1. 한눈에 보기 (TL;DR)
| 하고 싶은 일 | 바로 가는 위치 | 3단계 사용 순서 |
|---------------|----------------|------------------|
| 기존 문서 열기 | 좌측 트리(지식베이스) | 문서 클릭 → 중앙 에디터 표시 → 수정/저장 |
| 새 문서 생성 | 좌측 트리 우클릭(또는 +) | 새 파일 생성 → 내용 작성 → 저장 |
| 이전 버전 변경점 보기 | 에디터 상단 Diff/버전 선택 | 버전 선택 → 비교 → 필요 시 병합 |
| 버전 충돌 해결 | 저장 시 409 알림 | 최신 내용 불러옴 → 차이 확인 → 병합 후 다시 저장 |
| 외부 자료 기반 AI 문서 생성 | 상단(검색/생성 패널) “외부자료” 탭 | 주제 입력 → 생성 시작 → 완료 후 자동 초안 열기 |
| 내부 검색(파일+내용) | “내부자료 검색” 탭 | 키워드 입력 → 결과 클릭 → 문서 열기 |
| 문서 구조(Outline) 보기 | 에디터 우측/상단 목차 | 헤더 클릭 → 해당 위치 스크롤 |
| 실시간 생성 진행 확인 | “최근 생성 작업” 패널 | 상태/단계 확인 → 실패 시 Retry |

---
## 2. 화면 구성 설명
| 영역 | 설명 | 핵심 액션 |
|------|------|-----------|
| 상단 바 | 모드 전환/메뉴 | 커리큘럼 ↔ 지식베이스 이동 |
| 좌측 패널 | 모드에 따라 트리 or 검색/생성 | 파일 선택 / 문서 생성 / 검색 |
| 중앙 에디터 | Markdown 편집, 버전 비교, 충돌 해소 | 작성 / 저장 / Diff / Merge |
| (지식베이스 모드) 작업 상태 바 | 하단 또는 별도 패널 | AI 문서 생성 단계/진행률 표시 |
| (옵션) 우측 패널 | 향후 AI 도우미 확장 | 추가 도움 (현재 선택적) |

시각적 구조(개념)
```
┌────────────┬───────────────────────────────┬──────────┐
│ 좌측 패널  │    중앙: 문서 에디터 / Diff     │(옵션)우측 │
│ (트리/검색)│    - 헤더 목차(Outline)         │   패널    │
├────────────┴───────────────────────────────┴──────────┤
│                 (하단) 작업 상태 / 메시지                      │
└────────────────────────────────────────────────────────┘
```

---
## 3. 가장 많이 쓰는 8가지 작업

### 3.1 문서 열기
1) 좌측 트리에서 폴더 확장 → 파일 클릭  
2) 중앙 에디터에 내용 로드  
3) 상단 목차(Outline) 목록을 통해 섹션 이동 가능

### 3.2 새 문서 만들기
1) 트리에서 부모 폴더 우클릭 또는 “디렉토리/파일 생성” 버튼  
2) 파일명 입력 (예: `aws/s3/introduction.md`)  
3) 기본 내용 작성 후 저장 (자동 버전 1 생성)

### 3.3 문서 저장 & 버전 기록
1) 수정 후 저장 버튼(또는 Ctrl/Cmd+S 예정)  
2) 서버가 성공 응답 → 최신 버전 번호 갱신  
3) 변경 이력 화면에서 이전 버전 목록 확인 (작성 메시지 있으면 함께 표시)

### 3.4 버전 차이(Diff) 확인
1) 버전 비교 패널 열기  
2) 좌/우 버전 선택 (예: v3 ↔ v5)  
3) Diff 뷰:  
	- Unified: 한 줄에 +/− 표시  
	- Side-by-Side: 삭제/추가 줄 나란히  
	- 변경 줄은 색상 강조 (빨강=삭제, 초록=추가)  
4) 필요 시 특정 변경을 수동 반영 후 다시 저장

### 3.5 저장 충돌(Merge Conflict) 해결 (409 발생 시)
충돌이란? 다른 사용자가 이미 최신 버전을 만든 뒤 내가 예전 버전 기반으로 저장하려 할 때 발생.
절차:
1) 충돌 알림 → 시스템이 “최신 서버 버전”을 불러옴  
2) 충돌 패널에서 “내 로컬 변경” vs “최신 서버” 차이 표시  
3) 3‑way merge 보조 기능으로 자동 병합 시도  
4) 남은 충돌 블록 수동 편집 → 재저장(버전 업)  
TIP: 강제 저장(force)은 최후의 수단 (다른 사람 변경 덮어쓸 위험)

### 3.6 내부 검색 (파일명 + 본문)
1) “내부자료 검색” 탭 선택  
2) 키워드 입력 후 Enter  
3) 결과 리스트에서 제목/본문 하이라이트 확인  
4) 클릭 → 해당 파일 열림  
초기화: ‘전체 보기’ 클릭

### 3.7 외부 자료 기반 AI 문서 생성
1) “외부자료 검색 및 문서 생성” 탭 전환  
2) 주제 입력 (예: “AWS Lambda 서버리스 아키텍처”)  
3) (선택) 저장 경로 지정 (`aws/lambda/architecture`)  
4) (테스트용) 실패 스테이지 드롭다운은 일반 사용 시 비워둠  
5) [AI 문서 생성] 클릭 → 상태바(collect → extract → cluster → summarize → compose → validate)  
6) 완료 시 초안 Markdown 자동 생성 & 에디터에서 열림  
7) 내용 다듬고 저장

### 3.8 최근 생성 작업 모니터링
1) “최근 생성 작업” 패널에서 ID/상태/진행률 확인  
2) 오류(⚠) 표시 시 마우스오버로 원인 확인  
3) 실패 → Retry 버튼으로 재시도  
4) 오래된 항목은 자동으로 아래로 밀림 / 새로고침 버튼 수동 갱신 가능

---
## 4. 단계별 튜토리얼 (예시 워크플로우)
시나리오: “AWS S3 비용 최적화” 문서가 아직 없음 → AI로 초안 생성 → 편집 → 버전 비교 → 수정 저장

| 단계 | 행동 | 결과 |
|------|------|------|
| 1 | 외부자료 탭에서 주제 입력 후 생성 | 작업 상태 collect 시작 |
| 2 | compose → validate 완료 대기 | 초안 v1 자동 생성 |
| 3 | 불필요 섹션 삭제/추가 작성 | 내용 수정됨(로컬) |
| 4 | 저장 | v2 생성, 버전 리스트에 추가 |
| 5 | Diff에서 v1 ↔ v2 비교 | 변경 라인 확인 |
| 6 | 팀원이 동시에 수정 후 저장 → 내가 다시 저장 | 409 충돌 발생 |
| 7 | 충돌 패널에서 차이 조정 후 재저장 | 병합 완료 v3 |

---
## 5. 문서/버전/머지 개념 간단 정리
| 용어 | 뜻 | 비고 |
|------|-----|------|
| 버전(Version) | 저장 시마다 증가하는 번호 | v1부터 시작 |
| 메시지(Message) | 저장 시 선택적 변경 설명 | Diff 목록에서 도움 |
| Diff | 두 버전의 줄 단위 차이 | Unified/Side 선택 |
| 충돌(Conflict) | 최신보다 뒤처진 기준으로 저장 시 발생 | 409 상태코드 |
| 3‑way Merge | base / local / remote 비교 병합 | 자동+수동 혼합 |
| Generation Task | AI 문서 생성 파이프라인 실행 단위 | WebSocket 이벤트 |

---
## 6. AI 문서 생성 파이프라인 단계
| 단계 | 설명 | 실패 시 조치 |
|------|------|---------------|
| collect | 외부 소스 수집 | 네트워크 문제 → Retry |
| extract | 본문/핵심 추출 | 포맷 불일치 → 재시도 |
| cluster | 중복/주제 그룹화 | 데이터 적음 → 주제 구체화 |
| summarize | 요약/구조화 | 모델 제한 → 재시도 |
| compose | Markdown 초안 생성 | 길이 초과 → 주제 분할 |
| validate | 간단 검증/정리 | 사소한 실패 → 무시 후 수동 편집 |

진행률이 멈춘 듯 보이면 새로고침 대신 잠시 대기 (이벤트는 버퍼링 후 재전송됨).

---
## 7. 파일 & 디렉토리 작업
| 작업 | UI 액션 | 서버 요청 | 주의 |
|------|---------|-----------|------|
| 파일 생성 | 트리 > 새 파일 | POST /api/kb/item | 확장자 .md 권장 |
| 폴더 생성 | 트리 > 새 디렉토리 | POST /api/kb/item(type=directory) | 빈 폴더 허용 |
| 이름 변경 | 항목 > Rename | PATCH /api/kb/item(new_path) | 참조 링크 영향 가능 |
| 이동 | 드래그&드롭 | POST /api/kb/move | 동일명 존재시 실패 |
| 삭제(파일) | 삭제 버튼 | DELETE /api/kb/item | 복구 기능 아직 없음 |
| 삭제(폴더) | 삭제 (재귀) | DELETE /api/kb/directory?recursive=true | 하위 모두 삭제 |

---
## 8. 단축키 (예정/또는 커스텀)
| 액션 | 단축키 (제안) |
|------|---------------|
| 저장 | Ctrl/Cmd + S |
| 사이드바 토글 | Ctrl/Cmd + B |
| 검색 패널 이동 | Ctrl/Cmd + K |
| 버전 비교 열기 | Ctrl/Cmd + D |
| 목차 포커스 | Ctrl/Cmd + Shift + O |

실제 반영 여부는 좌측/상단 안내에 추후 아이콘으로 표시 예정.

---
## 9. 문제 해결 (Troubleshooting)
| 상황 | 증상 | 원인 | 해결 |
|------|------|------|------|
| 저장 충돌 | 409 발생 | 다른 사용자 선행 저장 | 충돌 패널 병합 후 재저장 |
| Diff 안 뜸 | 빈 화면 | 선택 버전 동일 | 다른 버전 선택 |
| AI 생성 멈춤 | 진행률 고정 | 일시적 네트워크/WS | 30초 대기 → Retry |
| 문서 안 열림 | “Load failed” | 경로 오탈자 / 삭제됨 | 트리 새로고침 후 재확인 |
| WebSocket 반복 연결 | 로그에 다수 connection open | 다중 마운트 | 중복 컴포넌트 확인 / 단일 구독 유지 |
| 파일 이동 실패 | 4xx 반환 | 대상 위치 이미 존재 | 새 이름 선택 후 이동 |

로그 확인: 브라우저 콘솔(F12) + 백엔드 컨테이너 로그.

---
## 10. FAQ
Q1. 왜 저장 메시지를 적어야 하나요?  
A. 나중에 버전 목록에서 “왜 바꿨는지” 빠르게 파악 가능해 협업 품질이 올라갑니다.

Q2. 강제 저장(force) 옵션은?  
A. 충돌을 무시하고 덮어쓰나 팀 작업 시 변경 손실 위험이 높아 지양.

Q3. AI 생성 문서 품질이 낮아요.  
A. 주제를 더 구체화(“AWS S3 라이프사이클 정책 비용 최적화”)하거나 큰 주제를 여러 개로 분할.

Q4. 문서가 너무 길어 Diff가 느립니다.  
A. 일부 섹션을 분리해 모듈화하거나, 대용량 Diff 가상화 기능 도입 예정.

Q5. Markdown에 이미지/다이어그램 추가는?  
A. 현재 텍스트 중심. 추후 Assets 업로드 기능 예정.

---
## 11. 베스트 프랙티스
1. 작은 단위로 자주 저장 (충돌 범위 축소)  
2. 버전 메시지는 “동사 + 대상 + 목적” (예: “Refactor: S3 섹션 구조 단순화”)  
3. AI 생성 초안은 바로 배포하지 말고 최소 1회 검토  
4. 중복/유사 문서는 통합 후 Redirect(추후 기능) 계획  
5. 폴더 네이밍은 소문자-kebab-case 유지 (일관성 + 링크 편리)

---
## 12. 용어 정리 (Glossary)
| 용어 | 영어 | 설명 |
|------|------|------|
| 지식베이스 | Knowledge Base | 내부 학습/참고 문서 저장소 |
| 버전 충돌 | Version Conflict | 동시에 다른 버전 기반 저장 시 발생 |
| 병합 | Merge | 차이 조정 후 단일 문서로 합치기 |
| 파이프라인 | Generation Pipeline | AI 문서 생성 단계 흐름 |
| 태스크 | Task | 비동기 처리 단위 (문서 생성 등) |

---
## 13. 향후 예정 기능 (Roadmap Snapshot)
- Diff 가상 스크롤 & 대용량 최적화  
- AI 기반 품질 점수 & 개선 제안  
- 다중 선택 병합 도우미  
- 이미지/다이어그램 포함 지원  
- 협업 Presence (동시 편집자 표시)

---
## 14. (부록) API 개요 (요약형)
| 엔드포인트 | 목적 | 비고 |
|------------|------|------|
| GET /api/kb/item | 문서 조회 | path 쿼리 |
| PATCH /api/kb/item | 문서 저장(버전) | 409 충돌 처리 |
| GET /api/kb/versions | 버전 목록 | 최근 순 |
| GET /api/kb/diff | 통합 Diff | v1,v2 필요 |
| GET /api/kb/diff/structured | 구조화 Diff | side-by-side 활용 |
| POST /api/kb/outline | 목차 추출 | 헤더 기반 |
| POST /api/kb/compose/external | AI 생성 시작 | task_id 반환 |
| GET /api/kb/tasks/:id | 생성 상태 | 단계/진행률 |
| WS /api/kb/tasks/ws | 실시간 이벤트 | 재연결 지원 |

---
**문서 버전:** 1.0 (사용자 친화 가이드 개편)  
**최종 수정:** 2025-08-21  
**작성:** MCP Cloud AI Assistant  
**피드백 환영:** 개선 의견은 `docs/` PR 또는 Issue 등록
